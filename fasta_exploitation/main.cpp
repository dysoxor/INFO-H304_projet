#include "fasta.h"
#include "binary.h"




int main( int argc, char **argv ){
  // It verify if the query file is in parameter
  if( argc != 2 ){
      cerr << "need 1 parameter" << endl;
      return EXIT_FAILURE;
  }
  //it read the name and the content of query sequence
  string name, content = "";
  List *listProtein = readFasta(argv[1]);

  if ( listProtein->numOfProtein == 0){
    cerr << "file in parameter is empty or inaccessible" << endl;
    return EXIT_FAILURE;
  }else{
    //cout << "name:  " << name << endl;
    //cout << "content:  " << content << endl;
  }

  // create an object PIN wich read the file *.pin
  PIN *filePIN = new PIN();
  filePIN->read();
  // create an object PSQ which read the file *.psq
  PSQ *filePSQ = new PSQ();
  // get the index of the corresponding sequence in datafile
  int index = filePSQ->read(filePIN, content);

  if (index != -1){
    // if index exists it get the info about the query sequence in *.phr
    PHR *filePHR = new PHR();
    filePHR->read(filePIN,index);
    delete filePHR;
  }

  delete filePIN;
  delete filePSQ;



  return 0;
}
